import{_ as le}from"./Toolbar.SyTgNAG-.js";import{d as ne}from"./dexie.D-7-Z1O5.js";import{u as ae}from"./ImportStore.SGARuJ_5.js";import{L as oe,c9 as ie,N as ue,cn as se,c6 as re,c as m,r,H as ce,P as de,c8 as fe,z as t,b1 as w,Y as h,cx as M,b2 as me,cf as ve,_ as pe,v as T,A as o,t as S,B as k,Z as ge,W as Ve}from"./entry.DdhUEr0K.js";import{a as ke,f as Ce,b as he}from"./VList.BRdpvtPk.js";import{m as be,c as ye,u as Re,d as $,f as we,e as Se,i as Fe,g as Ie,o as _e,V as xe,j as Pe,n as ze}from"./VDialog.CyfazT6a.js";import{V as C,e as Be}from"./VSpacer.DxsQY8Kh.js";import{l as j}from"./index.Bz74hZy1.js";import{f as Ae}from"./forwardRefs.VRY2Fdu8.js";import"./scopeId.DTwomwSm.js";const Le=oe({chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},multiple:Boolean,showSize:{type:[Boolean,Number,String],default:!1,validator:e=>typeof e=="boolean"||[1e3,1024].includes(Number(e))},...be({prependIcon:"$file"}),modelValue:{type:Array,default:()=>[],validator:e=>ie(e).every(n=>n!=null&&typeof n=="object")},...ye({clearable:!0})},"VFileInput"),Ne=ue()({name:"VFileInput",inheritAttrs:!1,props:Le(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,n){let{attrs:F,emit:c,slots:s}=n;const{t:v}=se(),u=re(e,"modelValue"),{isFocused:a,focus:I,blur:E}=Re(e),_=m(()=>typeof e.showSize!="boolean"?e.showSize:void 0),x=m(()=>(u.value??[]).reduce((l,i)=>{let{size:p=0}=i;return l+p},0)),P=m(()=>M(x.value,_.value)),y=m(()=>(u.value??[]).map(l=>{const{name:i="",size:p=0}=l;return e.showSize?`${i} (${M(p,_.value)})`:i})),Q=m(()=>{var i;const l=((i=u.value)==null?void 0:i.length)??0;return e.showSize?v(e.counterSizeString,l,P.value):v(e.counterString,l)}),z=r(),B=r(),f=r(),q=m(()=>a.value||e.active),A=m(()=>["plain","underlined"].includes(e.variant));function R(){var l;f.value!==document.activeElement&&((l=f.value)==null||l.focus()),a.value||I()}function O(l){L(l)}function W(l){c("mousedown:control",l)}function L(l){var i;(i=f.value)==null||i.click(),c("click:control",l)}function G(l){l.stopPropagation(),R(),me(()=>{u.value=[],ve(e["onClick:clear"],l)})}return ce(u,l=>{(!Array.isArray(l)||!l.length)&&f.value&&(f.value.value="")}),de(()=>{const l=!!(s.counter||e.counter),i=!!(l||s.details),[p,H]=fe(F),{modelValue:Me,...J}=$.filterProps(e),X=we(e);return t($,w({ref:z,modelValue:u.value,"onUpdate:modelValue":g=>u.value=g,class:["v-file-input",{"v-file-input--chips":!!e.chips,"v-input--plain-underlined":A.value},e.class],style:e.style,"onClick:prepend":O},p,J,{centerAffix:!A.value,focused:a.value}),{...s,default:g=>{let{id:b,isDisabled:V,isDirty:N,isReadonly:U,isValid:Y}=g;return t(Se,w({ref:B,"prepend-icon":e.prependIcon,onMousedown:W,onClick:L,"onClick:clear":G,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},X,{id:b.value,active:q.value||N.value,dirty:N.value,disabled:V.value,focused:a.value,error:Y.value===!1}),{...s,default:Z=>{var D;let{props:{class:K,...ee}}=Z;return t(h,null,[t("input",w({ref:f,type:"file",readonly:U.value,disabled:V.value,multiple:e.multiple,name:e.name,onClick:d=>{d.stopPropagation(),U.value&&d.preventDefault(),R()},onChange:d=>{if(!d.target)return;const te=d.target;u.value=[...te.files??[]]},onFocus:R,onBlur:E},ee,H),null),t("div",{class:K},[!!((D=u.value)!=null&&D.length)&&(s.selection?s.selection({fileNames:y.value,totalBytes:x.value,totalBytesReadable:P.value}):e.chips?y.value.map(d=>t(Fe,{key:d,size:"small",color:e.color},{default:()=>[d]})):y.value.join(", "))])])}})},details:i?g=>{var b,V;return t(h,null,[(b=s.details)==null?void 0:b.call(s,g),l&&t(h,null,[t("span",null,null),t(Ie,{active:!!((V=u.value)!=null&&V.length),value:Q.value},s.counter)])])}:void 0})}),Ae({},z,B,f)}}),Ue={setup(){const e=r([]);return ne.getRoutes().then(n=>{e.value=n}),{list:e,fab:r(!1),dialog:r(!1),QRscanActive:r(!1),newRouteName:r(null),newRouteURL:r(null),newFile:r(null),receivedJSON:r({})}},methods:{getRoute(e){return"/route/"+e},goQRScan(){this.$router.push("/qrscanimport/")},submitDialog(){this.dialog=!1,this.newRouteURL&&fetch(this.newRouteURL).then(e=>e.text()).then(e=>parseText(e)),this.newFile&&(ae().importFiles(this.newFile),this.$router.push("/import/"))}}};function De(e,n,F,c,s,v){const u=le;return S(),T(h,null,[t(u,null,{default:o(()=>[t(C,{icon:"",onClick:n[0]||(n[0]=a=>c.dialog=!0)},{default:o(()=>[t(j,null,{default:o(()=>[k("mdi-upload")]),_:1})]),_:1}),t(C,{icon:"",onClick:n[1]||(n[1]=a=>v.goQRScan())},{default:o(()=>[t(j,null,{default:o(()=>[k("mdi-qrcode")]),_:1})]),_:1})]),_:1}),t(ke,{lines:"two"},{default:o(()=>[t(Ce,null,{default:o(()=>[k("Wishlist")]),_:1}),(S(!0),T(h,null,ge(c.list,(a,I)=>(S(),Ve(he,{key:a._id,title:a.name,subtitle:a.desc,to:v.getRoute(encodeURIComponent(a._id)),router:""},{append:o(()=>[t(C,{color:a.bookmark?"secondary":"grey",icon:"mdi-bookmark",variant:"text"},null,8,["color"])]),_:2},1032,["title","subtitle","to"]))),128))]),_:1}),t(_e,{modelValue:c.dialog,"onUpdate:modelValue":n[5]||(n[5]=a=>c.dialog=a),"max-width":"600px"},{default:o(()=>[t(xe,{title:"Upload GPX"},{default:o(()=>[t(Pe,null,{default:o(()=>[t(Ne,{modelValue:c.newFile,"onUpdate:modelValue":n[2]||(n[2]=a=>c.newFile=a),"show-size":"",multiple:"",clearable:"",counter:"",accept:".gpx",label:"Choose file"},null,8,["modelValue"])]),_:1}),t(ze,null,{default:o(()=>[t(Be),t(C,{color:"blue darken-1",text:"",onClick:n[3]||(n[3]=a=>c.dialog=!1)},{default:o(()=>[k(" Close ")]),_:1}),t(C,{color:"blue darken-1",text:"",onClick:n[4]||(n[4]=a=>v.submitDialog())},{default:o(()=>[k(" Save ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}const Je=pe(Ue,[["render",De]]);export{Je as default};
