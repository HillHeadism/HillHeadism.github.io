import{_ as le}from"./Toolbar.DHF4ERVA.js";import{d as ae}from"./dexie.BGUucr1y.js";import{u as ne}from"./ImportStore.cuLjLlT0.js";import{L as oe,ca as ue,N as ie,co as se,c7 as re,c as V,r as c,H as ce,P as de,c9 as fe,z as t,b2 as P,Z as h,cA as M,b3 as me,cg as ve,cB as pe,v as T,A as u,t as B,B as y,$ as Ve,X as ke}from"./entry.BnpdOWKH.js";import{a as Ce,e as ge,b as ye}from"./VList.CfXI509e.js";import{m as be,c as he,u as Ie,d as E,f as Se,e as Re,i as _e,g as we,o as xe,V as Fe,l as Pe,n as Be}from"./VDialog.OKGhRlX7.js";import{V as b,e as ze}from"./VSpacer.BqmXq50x.js";import{l as j}from"./index.DMUjZW0j.js";import{f as Ae}from"./forwardRefs.gpgpW3rb.js";import"./scopeId.JUXDCElC.js";const $e=oe({chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},multiple:Boolean,showSize:{type:[Boolean,Number,String],default:!1,validator:e=>typeof e=="boolean"||[1e3,1024].includes(Number(e))},...be({prependIcon:"$file"}),modelValue:{type:Array,default:()=>[],validator:e=>ue(e).every(m=>m!=null&&typeof m=="object")},...he({clearable:!0})},"VFileInput"),Le=ie()({name:"VFileInput",inheritAttrs:!1,props:$e(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,m){let{attrs:I,emit:S,slots:s}=m;const{t:d}=se(),n=re(e,"modelValue"),{isFocused:v,focus:x,blur:r}=Ie(e),o=V(()=>typeof e.showSize!="boolean"?e.showSize:void 0),R=V(()=>(n.value??[]).reduce((l,i)=>{let{size:k=0}=i;return l+k},0)),a=V(()=>M(R.value,o.value)),_=V(()=>(n.value??[]).map(l=>{const{name:i="",size:k=0}=l;return e.showSize?`${i} (${M(k,o.value)})`:i})),q=V(()=>{var i;const l=((i=n.value)==null?void 0:i.length)??0;return e.showSize?d(e.counterSizeString,l,a.value):d(e.counterString,l)}),z=c(),A=c(),p=c(),X=V(()=>v.value||e.active),$=V(()=>["plain","underlined"].includes(e.variant));function F(){var l;p.value!==document.activeElement&&((l=p.value)==null||l.focus()),v.value||x()}function G(l){L(l)}function H(l){S("mousedown:control",l)}function L(l){var i;(i=p.value)==null||i.click(),S("click:control",l)}function O(l){l.stopPropagation(),F(),me(()=>{n.value=[],ve(e["onClick:clear"],l)})}return ce(n,l=>{(!Array.isArray(l)||!l.length)&&p.value&&(p.value.value="")}),de(()=>{const l=!!(s.counter||e.counter),i=!!(l||s.details),[k,Q]=fe(I),{modelValue:Ne,...W}=E.filterProps(e),Z=Se(e);return t(E,P({ref:z,modelValue:n.value,"onUpdate:modelValue":C=>n.value=C,class:["v-file-input",{"v-file-input--chips":!!e.chips,"v-input--plain-underlined":$.value},e.class],style:e.style,"onClick:prepend":G},k,W,{centerAffix:!$.value,focused:v.value}),{...s,default:C=>{let{id:w,isDisabled:g,isDirty:N,isReadonly:U,isValid:J}=C;return t(Re,P({ref:A,"prepend-icon":e.prependIcon,onMousedown:H,onClick:L,"onClick:clear":O,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},Z,{id:w.value,active:X.value||N.value,dirty:N.value,disabled:g.value,focused:v.value,error:J.value===!1}),{...s,default:K=>{var D;let{props:{class:Y,...ee}}=K;return t(h,null,[t("input",P({ref:p,type:"file",readonly:U.value,disabled:g.value,multiple:e.multiple,name:e.name,onClick:f=>{f.stopPropagation(),U.value&&f.preventDefault(),F()},onChange:f=>{if(!f.target)return;const te=f.target;n.value=[...te.files??[]]},onFocus:F,onBlur:r},ee,Q),null),t("div",{class:Y},[!!((D=n.value)!=null&&D.length)&&(s.selection?s.selection({fileNames:_.value,totalBytes:R.value,totalBytesReadable:a.value}):e.chips?_.value.map(f=>t(_e,{key:f,size:"small",color:e.color},{default:()=>[f]})):_.value.join(", "))])])}})},details:i?C=>{var w,g;return t(h,null,[(w=s.details)==null?void 0:w.call(s,C),l&&t(h,null,[t("span",null,null),t(we,{active:!!((g=n.value)!=null&&g.length),value:q.value},s.counter)])])}:void 0})}),Ae({},z,A,p)}}),Oe={__name:"index",setup(e){const m=pe(),I=c([]);ae.getRoutes().then(r=>{I.value=r});const S=r=>"/route/"+r;c(!1),c({});const s=()=>{m.push("/qrscanimport/")},d=c(!1),n=c(null),v=c(null),x=()=>{d.value=!1,v.value&&fetch(v.value).then(r=>r.text()).then(r=>parseText(r)),n.value&&(ne().importFiles(n.value),m.push("/import/"))};return(r,o)=>{const R=le;return B(),T(h,null,[t(R,null,{default:u(()=>[t(b,{icon:"",onClick:o[0]||(o[0]=a=>d.value=!0)},{default:u(()=>[t(j,null,{default:u(()=>[y("mdi-upload")]),_:1})]),_:1}),t(b,{icon:"",onClick:o[1]||(o[1]=a=>s())},{default:u(()=>[t(j,null,{default:u(()=>[y("mdi-qrcode")]),_:1})]),_:1})]),_:1}),t(Ce,{lines:"two"},{default:u(()=>[t(ge,null,{default:u(()=>[y("Wishlist")]),_:1}),(B(!0),T(h,null,Ve(I.value,(a,_)=>(B(),ke(ye,{key:a._id,title:a.name,subtitle:a.desc,to:S(encodeURIComponent(a._id)),router:""},{append:u(()=>[t(b,{color:a.bookmark?"secondary":"grey",icon:"mdi-bookmark",variant:"text"},null,8,["color"])]),_:2},1032,["title","subtitle","to"]))),128))]),_:1}),t(xe,{modelValue:d.value,"onUpdate:modelValue":o[5]||(o[5]=a=>d.value=a),"max-width":"600px"},{default:u(()=>[t(Fe,{title:"Upload GPX"},{default:u(()=>[t(Pe,null,{default:u(()=>[t(Le,{modelValue:n.value,"onUpdate:modelValue":o[2]||(o[2]=a=>n.value=a),"show-size":"",multiple:"",clearable:"",counter:"",accept:".gpx",label:"Choose file"},null,8,["modelValue"])]),_:1}),t(Be,null,{default:u(()=>[t(ze),t(b,{color:"blue darken-1",text:"",onClick:o[3]||(o[3]=a=>d.value=!1)},{default:u(()=>[y(" Close ")]),_:1}),t(b,{color:"blue darken-1",text:"",onClick:o[4]||(o[4]=a=>x())},{default:u(()=>[y(" Save ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}};export{Oe as default};
